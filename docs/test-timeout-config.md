# AI接口超时配置更新测试

## 📋 更新内容

### 1. 新的超时配置策略

```typescript
const TIMEOUT_CONFIG = {
  CONNECTION_TEST: 15000,    // 连接测试：15秒
  SIMPLE_CHAT: 60000,        // 简单对话：60秒  
  COMPLEX_ANALYSIS: 90000,   // 复杂分析：90秒
  STREAM_RESPONSE: 120000,   // 流式响应：120秒
  IMAGE_PROCESSING: 75000,   // 图像处理：75秒
  DEFAULT: 60000             // 默认：60秒
} as const
```

### 2. 智能超时选择

系统现在会根据请求类型自动选择合适的超时时间：

- **流式响应**: 120秒 (原30秒 → 120秒)
- **图像处理**: 75秒 (原30秒 → 75秒)  
- **普通对话**: 60秒 (原30秒 → 60秒)
- **连接测试**: 15秒 (保持不变)

### 3. 更新的文件

1. `lib/openai-client.ts` - 主要OpenAI客户端
2. `lib/frontend-ai-client.ts` - 前端AI客户端
3. `app/api/diagnose/route.ts` - 诊断API

## 🧪 测试建议

### 1. 基础功能测试
- [ ] 普通AI对话是否正常工作
- [ ] 流式响应是否正常工作
- [ ] 图像上传和处理是否正常工作
- [ ] 连接测试功能是否正常工作

### 2. 超时行为测试
- [ ] 长时间AI响应是否不再频繁超时
- [ ] 网络较慢时是否有更好的用户体验
- [ ] 错误消息是否更加友好

### 3. 性能影响测试
- [ ] 正常响应速度是否受影响
- [ ] 资源使用是否正常

## 🎯 预期改进

1. **减少超时错误** - 特别是复杂AI任务
2. **更好的用户体验** - 减少因网络延迟导致的失败
3. **智能化配置** - 根据任务类型自动调整
4. **保持效率** - 连接测试等快速操作保持原有速度

## 📝 注意事项

- 超时时间增加可能会让用户在网络真正有问题时等待更长时间
- 建议在实际使用中观察效果，必要时可以进一步调整
- 流式响应的120秒超时主要针对长对话场景
